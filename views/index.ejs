<%- include("partials/header.ejs") %>

<body>

<div class="container">
    
    <!--Featured Article-->
    <a class="preview-row" href="/posts/<%= featuredTitle %>">
    <div class="row featured">
        <div class="col-7 featured">
            <h2 class="featured-title"> <%= featuredTitle %> </h2>
            <p class="featured-subtitle"> <%= featuredSubtitle %> </p>
            <p class="featured-author"> <%= featuredAuthor %> </p>
        </div>
        <div class="col-12 col-md-6 featured">
            <img class="profile" src="<%=featuredImage%>" alt="sf profile">
        </div>
    </div>
    </a>

    <div class="row line">
        <div class="col-12 featured-line">
            <hr>
        </div>
    </div>

    <!--Pinned Articles-->
    <!--Loop through pinnedArray-->
    <% if (locals.pinnedArray) { %>
        <% pinnedArray.forEach(function(pinnedArticle, index) { %>

            <% if (index == pinnedArray.length - 1) { %>
                <a class="preview-row" href="/posts/<%= pinnedArticle[0] %>">
                    <div class="row latest">
                        <div class="col-11 featured-preview">
                            <p class="preview-category"> <%= pinnedArticle[6] %> </p>
                            <h5 class="preview-title-text pinned"> <%= pinnedArticle[0] %> </h5>
                            <p class="preview-author"> <%= pinnedArticle[2] %> </p>
                            <hr class="thick-line">
                        </div>
                    </div>
                </a> 
            <% } else { %>
                <a class="preview-row" href="/posts/<%= pinnedArticle[0] %>">
                    <div class="row latest">
                        <div class="col-11 featured-preview">
                            <p class="preview-category"> <%= pinnedArticle[6] %> </p>
                            <h5 class="preview-title-text pinned"> <%= pinnedArticle[0] %> </h5>
                            <p class="preview-author"> <%= pinnedArticle[2] %> </p>
                            <hr class="thin-line">
                        </div>
                    </div>
                </a> 
            <% } %>

        <%  }) %>
    <% } %>

    <!--Latest Articles-->
    <div class="row line">
        <div class="col-12 latest">
            <h6 class="latestTitle">The Latest</h6>
        </div>
    </div>

    <!--Loop through the posts and add them to the div tags-->
    <!--"..." is used to make a copy of the array before reversing the order-->
    <!--Made a copy just in case it's helpful to have the original array structure later-->
    <% if (locals.postsArray) { %>
        <% [...postsArray].reverse().forEach(function(post) { %>
            
            <div class="row line">
                <div class="col-12 line">
                    <hr>
                </div>
            </div>

            <% if (post[0] == featuredTitle) { %>

                <a class="preview-row" href="/posts/<%= post[0] %>">
                    <div class="row latest">
                        <div class="col-12 featured-preview">
                            <img class="featured-thumbnail" src= "<%= post[5] %>" alt="sf profile">
                            <h6 class="featured-label">Featured Article</h6>
                            <h5 class="preview-title-text"> <%= post[0] %> </h5>
                            <p class="preview-author"> <%= post[2] %> </p>
                            <p class="preview-datetime text-muted">  <%= post[3] %> &#x2022; <%= post[4] %> </p>
                        </div>
                    </div>
                    </a> 
            
            <% } else { %>

                <a class="preview-row" href="/posts/<%= post[0] %>">
                <div class="row latest">
                    <div class="col-8 col-md-3 previewTitle">
                        <p class="preview-category"> <%= post[6] %> </p>
                        <h5 class="preview-title-text"> <%= post[0] %> </h5>
                        <p class="preview-author"> <%= post[2] %> </p>
                        <p class="preview-datetime text-muted">  <%= post[3] %> &#x2022; <%= post[4] %> </p>
                    </div>
                    <div class="col-3 text-muted summary">
                        <p> <%= post[1].substring(0, 170) + "..." %> 
                            
                        </p>
                        
                    </div>
                    <div class="col-4 col-md-3 previewImage">
                        <img class="thumbnail" src= "<%= post[5] %>" alt="sf profile">
                    </div>
                </div>
                </a> 
            <% } %>
        <%  }) %>
   <% } %>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

</body>

