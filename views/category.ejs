<%- include("partials/header.ejs") %>

<body>
    <h1 class="category-page-title"> <%= category %> </h1>
<!--Loop through the posts and add them to the div tags-->
    <!--"..." is used to make a copy of the array before reversing the order-->
    <!--Made a copy just in case it's helpful to have the original array structure later-->
    <% if (locals.articlesInCategory) { %>
        <% [...articlesInCategory].reverse().forEach(function(post) { %>
            
            <div class="row line">
                <div class="col-12 line">
                    <hr>
                </div>
            </div>

            <% if (post.title == featuredTitle) { %>

                <a class="preview-row categorymatch" href="/posts/<%= post.title %>">
                    <div class="row latest">
                        <div class="col-12 featured-preview">
                            <img class="featured-thumbnail" src= "<%= post.image_path %>" alt="sf profile">
                            <h6 class="featured-label">Featured Article</h6>
                            <h5 class="preview-title-text"> <%= post.title %> </h5>
                            <p class="preview-author"> <%= post.author %> </p>
                            <p class="preview-datetime text-muted">  <%= post.time %> &#x2022; <%= post.date %> </p>
                        </div>
                    </div>
                    </a> 
            
            <% } else { %>

                <a class="preview-row categorymatch" href="/posts/<%= post.title %>">
                <div class="row latest">
                    <div class="col-8 col-md-3 previewTitle">
                        <p class="preview-category"> <%= post.category %> </p>
                        <h5 class="preview-title-text"> <%= post.title %> </h5>
                        <p class="preview-author"> <%= post.author %> </p>
                        <p class="preview-datetime text-muted">  <%= post.time %> &#x2022; <%= post.date %> </p>
                    </div>
                    <div class="col-3 text-muted summary">
                        <p> <%= post.article_content.substring(0, 170) + "..." %> 
                            
                        </p>
                        
                    </div>
                    <div class="col-4 col-md-3 previewImage">
                        <img class="thumbnail" src= "<%= post.image_path %>" alt="sf profile">
                    </div>
                </div>
                </a> 
            <% } %>
        <%  }) %>
   <% } %>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>